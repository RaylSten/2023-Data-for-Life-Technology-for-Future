"0",""
"0","scatter_ggplot ="
"0","  taipei.map %>%"
"0","  ggplot() +"
"0","  geom_sf(aes(fill = TOWNNAME), show.legend = F) +"
"0","  geom_sf_text(aes(label = TOWNNAME), size = 3) +"
"0","  geom_point(aes(x = X, y = Y), size = 0.5, "
"0","             col = ""black"", data = traffic, alpha = 0.5) +"
"0","  coord_cartesian()"
"0",""
"0","p1 <- ggplot(data = traffic_group, aes(x = as.factor(發生月份), "
"0","                                 y = total_count, group = 地區, color = 地區)) +"
"0","  labs(x = '車禍發生月份', y = '車禍總次數') +"
"0","  geom_line( size = 1.2) +"
"0","  geom_point() "
"2","警告： Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
Please use `linewidth` instead."
"0","df_group <- traffic %>% "
"0","  group_by(地區) %>% summarise(total_count = n())"
"0",""
"0","p2 <- ggplot(df_group, aes(x = reorder(as.factor(地區), -total_count), y = total_count, group = 地區, color = 地區, fill = 地區)) +"
"0","  geom_bar(stat = ""identity"") + "
"0","  labs(x = '車禍發生地區', y = '車禍總次數')"
"0",""
"0","ply1 <- ggplotly(p1)"
"0","ply2 <- ggplotly(p2)"
"0","ply3 <- ggplotly(scatter_ggplot)"
"2","警告： st_point_on_surface may not give correct results for longitude/latitude data"
"0","merge_1 <- subplot(ply1, ply2, nrows = 2) %>% "
"0","  layout(annotations = list(list(x = 0.6 , "
"0","                                 y = 1.05, "
"0","                                 text = ""車禍總次數與月份折線圖"", "
"0","                                 showarrow = F, "
"0","                                 xref = 'paper', "
"0","                                 yref = 'paper', "
"0","                                 size = 28), "
"0","                            list(x = 0.6, "
"0","                                 y = -0.08, "
"0","                                 text = ""車禍總次數與地區直方圖"", "
"0","                                 showarrow = F, "
"0","                                 xref = 'paper', "
"0","                                 yref = 'paper', "
"0","                                 size = 28))) "
"0","subplot(ply3, merge_1, widths = c(0.4, 0.6), nrows = 1) %>% "
"0","  layout(annotations = list(list(x = 0.15 , "
"0","                                 y = 1.05, "
"0","                                 text = ""車禍事故散佈圖"", "
"0","                                 showarrow = F, "
"0","                                 xref = 'paper', "
"0","                                 yref = 'paper', "
"0","                                 size = 28)) "
"0","  ) "
