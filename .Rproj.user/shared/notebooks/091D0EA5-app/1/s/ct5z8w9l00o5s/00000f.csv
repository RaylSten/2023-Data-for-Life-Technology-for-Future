"0","# Taipei Map"
"0",""
"0","taiwan.town.map <- st_read(""data/TOWN_MOI_1120317.shp"")"
"1","Reading layer `"
"1","TOWN_MOI_1120317"
"1","' from data source "
"1","
"
"1","  "
"1","`"
"1","C:\Users\user\Desktop\政大\競賽\內政部\shiny\Shiny\data\TOWN_MOI_1120317.shp"
"1","' "
"1","
"
"1","  "
"1","using driver `"
"1","ESRI Shapefile"
"1","'"
"1","
"
"1","Simple feature collection with 368 features and 7 fields"
"1","
"
"1","Geometry type: MULTIPOLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: 114.3593 ymin: 10.37135 xmax: 124.5612 ymax: 26.38528"
"1","
"
"1","Geodetic CRS:  GCS_TWD97[2020]
"
"0","taipei.map <- taiwan.town.map[taiwan.town.map$COUNTYNAME == ""臺北市"", ]"
"0",""
"0","# Traffic Complete"
"0","traffic <- read.csv(""data/traffic_complete.csv"", as.is = T,"
"0","                    fileEncoding = ""BIG5"", header = T)"
"0","traffic_c <- traffic[, c(1, 3, 4, 14, 15)]"
"0","colnames(traffic_c) <- c('發生月份', '肇事地點', '死亡人數', '經度', '緯度')"
"0","traffic_p <- traffic[, c(2, 14, 15)]"
"0","traffic_group <- traffic %>% "
"0","  group_by(地區, 發生月份) %>% summarise(total_count = n())"
"2","`summarise()` has grouped output by '地區'. You can override using the `.groups` argument."
"0","traffic_group$發生月份 <-as.factor(traffic_group$發生月份)"
"0",""
"0","# science"
"0","science <- read.csv(""data/science1.csv"", as.is = T, "
"0","                    fileEncoding = ""BIG5"", header = T)"
"0",""
"0","# road"
"0","road <- read.csv(""data/road.csv"", row.names = 1, encoding = 'BIG5')"
"0","road[road$AvgSpd >= 65, '是否超速'] <- 1"
"0","road[road$AvgSpd < 65, '是否超速'] <- 0"
"0","road$是否超速 <- factor(road$是否超速, levels = c(1, 0), labels = c(""是"", ""否""))"
"0","road <- road %>% filter(StartWgsX > 121.54)"
"0",""
"0","# radar"
"0","df1 <- read.csv(""data/traffic_complete.csv"", as.is = T,"
"0","                    fileEncoding = ""BIG5"", header = T)"
"0","x1 <- df1[df1$發生月份 >= 1 & df1$發生月份 <= 3,] %>% "
"0","  group_by(地區) %>% "
"0","  summarize(count = n())"
"0","x2 <- df1[df1$發生月份 >= 4 & df1$發生月份 <= 6,] %>% "
"0","  group_by(地區) %>% "
"0","  summarize(count = n()) "
"0","x3 <- df1[df1$發生月份 >= 7 & df1$發生月份 <= 9,] %>% "
"0","  group_by(地區) %>% "
"0","  summarize(count = n())"
"0","x4 <- df1[df1$發生月份 >= 10 & df1$發生月份 <= 12,] %>% "
"0","  group_by(地區) %>% "
"0","  summarize(count = n())"
"0","x1$count <- x1$count / max(x1$count)"
"0","x2$count <- x2$count / max(x2$count)"
"0","x3$count <- x3$count / max(x3$count)"
"0","x4$count <- x4$count / max(x4$count)"
"0","t_x1 <- t(x1)"
"0","t_x2 <- t(x2)"
"0","t_x3 <- t(x3)"
"0","t_x4 <- t(x4)"
"0","colnames <- t_x1[1,] "
"0","t_x1 <- t_x1[2, ]"
"0","t_x1 <- as.numeric(t_x1)"
"0","t_x1 <- data.frame(matrix(t_x1, ncol = 12))"
"0","colnames(t_x1) <- colnames"
"0","t_x1 <- rbind(rep(0, 12), rep(1, 12), t_x1)"
"0","colnames <- t_x2[1,] "
"0","t_x2 <- t_x2[2, ]"
"0","t_x2 <- as.numeric(t_x2)"
"0","t_x2 <- data.frame(matrix(t_x2, ncol = 12))"
"0","colnames(t_x2) <- colnames"
"0","t_x2 <- rbind(rep(0, 12), rep(1, 12), t_x2)"
"0","colnames <- t_x3[1,] "
"0","t_x3 <- t_x3[2, ]"
"0","t_x3 <- as.numeric(t_x3)"
"0","t_x3 <- data.frame(matrix(t_x3, ncol = 12))"
"0","colnames(t_x3) <- colnames"
"0","t_x3 <- rbind(rep(0, 12), rep(1, 12), t_x3)"
"0","colnames <- t_x4[1,] "
"0","t_x4 <- t_x4[2, ]"
"0","t_x4 <- as.numeric(t_x4)"
"0","t_x4 <- data.frame(matrix(t_x4, ncol = 12))"
"0","colnames(t_x4) <- colnames"
"0","t_x4 <- rbind(rep(0, 12), rep(1, 12), t_x4)"
"0","t_sumarize <- rbind(t_x1[3,], t_x2[3, ], t_x3[3, ], t_x4[3, ])"
"0","rownames(t_sumarize) <- c('春', '夏', '秋', '冬')"
"0","t_sumarize <- rbind(rep(1, 12), rep(0, 12), t_sumarize)"
"0","color <- c(""#00AFBB"", ""#E7B800"", ""#FC4E07"", '#A2CD5A')"
"0","y = t_sumarize[3:6,]"
"0","y = cbind(rownames(y), y) "
"0","colnames(y)[1] = 'Group'"
